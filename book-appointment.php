<?phpinclude('cnf.php');require_once(LIB_PATH.'users/appointments/add-init.php');include(LIB_HTML . 'header.php');?><script src="<?php echo SCRIPT_SITE_URL;?>jquery.validate.js"></script><script src="<?php echo SCRIPT_SITE_URL;?>additional-methods.js"></script><script src="<?php echo SCRIPT_SITE_URL;?>jquery-birthday-picker.min.js"></script><script src="<?php echo SCRIPT_SITE_URL;?>jquery.datetimepicker.js"></script><link rel="stylesheet" href="<?php echo CSS_SITE_URL;?>jquery.datetimepicker.css" type="text/css" /><style>.birthMonth,.birthDate,.birthYear{background:#FFF; width:25%; color:#000; margin-right:10px; border:1px solid #d4d6d7;    height: 40px; line-height: normal; padding: 7px 14px;}select{padding: 7px 14px !important; height: 40px !important;}</style><div class="main-banner five">    <div class="container">        <h2><span>Book an Appointment</span></h2>    </div></div><div class="container main-container">    <div class="contact-content">        <div class="row">            <!-- Contact Form Starts -->            <div class="col-sm-12 col-xs-12">                <h3>Book your appointment here</h3>                <div class="status alert alert-success contact-status"></div>                <?php                if(is_array($error) && count($error)>0) {                    ?>                    <!-- our error container -->                    <div class="error-container" style="display:block;">                        <ol>                            <?php                            foreach($error as $key=>$val) {                                ?>                                <li>                                    <label class="error" for="<?php echo $key;?>"><?php echo $val;?></label>                                </li>                                <?php                            }                            ?>                        </ol>                    </div>                    <?php                }                include(LIB_HTML.'message.php');                ?>                <form id="frmBookAppointment" class="contact-form" name="frmSignup" method="post" action="" role="form">                    <div class="row">                        <!--------------- STEP 1 ---------------->                        <div class="col-md-6">                            <div class="form-group">                                <label for="firstname">Category <span class="required">*</span></label>                                <select class="form-control" name="category_id" id="category_id">                                    <option value="">-- Select Category --</option>                                    <?php                                    if(is_array($arrCategories) && count($arrCategories)>0){                                        foreach($arrCategories as $category){                                            echo '<option value="'.$category['id'].'">'.$category['name'].'</option>';                                        }                                    }                                    ?>                                </select>                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="lastname">Service <span class="required">*</span></label>                                <select class="form-control" name="service_id" id="service_id">                                    <option value="">-- Select Service --</option>                                </select>                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="doctor_id">Doctor <span class="required">*</span></label>                                <select class="form-control" name="doctor_id" id="doctor_id">                                    <option value="">-- Select Doctor --</option>                                </select>                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="patient_count">Number of Patients <span class="required">*</span></label>                                <select class="form-control" name="patient_count" id="patient_count">                                    <?php                                    for($i=1; $i<11; $i++){                                        echo '<option value="'.$i.'">'.$i.'</option>';                                    }                                    ?>                                </select>                            </div>                        </div>                        <!----------- Step 2 ------------------>                        <div class="col-md-6">                            <div class="form-group">                                <label for="apt_date">Appointment Date <span class="required">*</span></label>                                <input type="text" name="apt_date" id="apt_date" class="form-control" value="<?php echo $apt_date;?>">                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="apt_time">Select Time <span class="required">*</span></label>                                <select name="apt_time" id="apt_time" class="form-control">                                    <option value="">-- Select Time --</option>                                    <?php                                    $curr_date = date("Y-m-d");                                    for($t=0; $t<24; $t++){                                        $time1 = date("g:i A", strtotime($curr_date.' '.$t.':00'));                                        $time2 = date("g:i A", strtotime($curr_date.' '.$t.':30'));                                        echo '<option value="'.$time1.'">'.$time1.'</option>';                                        echo '<option value="'.$time2.'">'.$time2.'</option>';                                    }                                    ?>                                </select>                            </div>                        </div>                        <!----------- Step 3 ------------------>                        <div class="col-md-6">                            <div class="form-group">                                <label for="name">Name <span class="required">*</span></label>                                <input type="text" class="form-control" name="name" id="name" value="<?php echo $name;?>">                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="name">Phone <span class="required">*</span></label>                                <input type="text" class="form-control" name="phone" id="phone" value="<?php echo $phone;?>">                            </div>                        </div>                        <div class="col-md-6">                            <div class="form-group">                                <label for="email">Email <span class="required">*</span></label>                                <input type="text" class="form-control" name="email" id="email" value="<?php echo $email;?>">                            </div>                        </div>                        <div class="col-md-12">                            <div class="form-group">                                <label for="phone">Notes</label>                                <textarea class="form-control" name="notes" id="notes" rows="3"><?php echo $notes;?></textarea>                            </div>                        </div>                        <!--------------- STEP 4 ---------------------->                        <div class="col-md-6">                            <div class="form-group">                                <label for="payment_type" class="fullW">Please tell us how you would like to pay <span class="required">*</span></label>                                <div class="radio radio-inline">                                    <input type="radio" name="payment_type" id="payment_type0" value="local" checked>                                    <label for="payment_type0"> I will pay locally </label>                                </div>                                <div class="radio radio-info radio-inline">                                    <input type="radio" name="payment_type" id="payment_type1" value="paypal">                                    <label for="payment_type1"> I will pay through Paypal </label>                                </div>                            </div>                        </div>                        <div id="paymentArea" style="display:none;">                            <div class="col-md-12">                                <h3>Make payment here</h3>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="card_holder_name">Card Holder Name <span class="required">*</span></label>                                    <input type="text" class="form-control" name="card_holder_name" id="card_holder_name" value="<?php echo $card_holder_name;?>">                                </div>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="card_type">Card Type: <span>*</span></label>                                    <select name="card_type" id="card_type" class="form-control">                                        <option value="">-- Select Card Type --</option>                                        <option value="visa">Visa</option>                                        <option value="master">Master Card</option>                                        <option value="maestro">Maestro</option>                                    </select>                                </div>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="card_number">Card Number: <span>*</span></label>                                    <input type="text" class="form-control" name="card_number" id="card_number" value="" />                                </div>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="cvv_number">CVV Number: <span>*</span></label>                                    <input type="text" class="form-control" name="cvv_number" id="cvv_number" value="" />                                </div>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="expiry_month">Expiry Month: <span>*</span></label>                                    <select name="expiry_month" id="expiry_month" class="form-control">                                        <option value="">-- Select Expiry Month --</option>                                        <?php                                        foreach($arrMonths as $key=>$value){                                            echo '<option value="'.$key.'">'.$value.'</option>';                                        }                                        ?>                                    </select>                                </div>                            </div>                            <div class="col-md-6">                                <div class="form-group">                                    <label for="expiry_year">Expiry Year: <span>*</span></label>                                    <select name="expiry_year" id="expiry_year" class="form-control">                                        <option value="">-- Select Expiry Year --</option>                                        <?php                                        $max_year = date("Y")+10;                                        for($i=date("Y"); $i<=$max_year; $i++){                                            echo '<option value="'.$i.'">'.$i.'</option>';                                        }                                        ?>                                    </select>                                </div>                            </div>                        </div>                        <div class="col-xs-12">                            <input type="hidden" name="book-appointment" value="submit">                            <input type="submit" class="btn btn-black text-uppercase" value="Submit">                        </div>                    </div>                </form>            </div>        </div>    </div></div><script type="text/javascript">$(document).on("change", "#category_id", function (e) {    var category_id = $(this).val();    if(category_id=='' || category_id==null) {        $("#service_id option").remove();        return false;    }    $(this).after('<img class="loading" src="<?php echo IMG_PATH;?>loading.gif" />');    $.ajax({        url:'<?php echo AJAX_PATH;?>listCategoryServices.php?cid='+category_id,        cache: false,        dataType: "html",        success:function(data){            $("#service_id option").remove();            $("#service_id").append(data);            $(".loading").remove();        }    });});$(document).on("change", "#service_id", function (e) {    var category_id = $("#category_id").val();    var service_id = $(this).val();    if(service_id=='' || service_id==null) {        $("#doctor_id option").remove();        return false;    }    $(this).after('<img class="loading" src="<?php echo IMG_PATH;?>loading.gif" />');    $.ajax({        url:'<?php echo AJAX_PATH;?>listDoctorsByService.php?cid='+category_id+'&sid='+service_id,        cache: false,        dataType: "html",        success:function(data){            $("#doctor_id option").remove();            $("#doctor_id").append(data);            $(".loading").remove();        }    });});//find out the already booked hours of doctor$(document).on("change", "#apt_date", function (e) {    var book_date = $(this).val();    var doctor_id = $("#doctor_id").val();    if(book_date!=='' && doctor_id!=="") {        $(this).after('<img class="loading" src="<?php echo IMG_PATH;?>loading.gif" />');        $.ajax({            url:'<?php echo AJAX_PATH;?>setAppointmentTime.php?dt='+book_date+'&did='+doctor_id,            cache: false,            dataType: "json",            success:function(data){                $.each(data, function(index, element) {                    $('#apt_time option[value="'+element+'"]').prop('disabled', true);                    $('#apt_time option[value="'+element+'"]').remove();                });                $(".loading").remove();                $(this).blur();                return false;            }        });    }    });$("input[name='payment_type']").click(function(){    var payment_type = $('input:radio[name=payment_type]:checked').val();    if(payment_type == "paypal"){        $("#paymentArea").fadeIn(100);    }else{        $("#paymentArea").fadeOut(100);    }});$(document).ready(function() {    $(".navbar-nav li").removeClass("active");    $("#navBook").addClass("active");    $("#category_id").val("<?php echo $category_id; ?>").trigger('change');    setTimeout(function() {        $("#service_id").val("<?php echo $service_id; ?>").trigger('change');    }, 1500);    setTimeout(function() {        $("#doctor_id").val("<?php echo $doctor_id; ?>");    }, 1500);    $("#apt_date").datetimepicker({        minDate: 0,        defaultDate: "+1d",        changeMonth: true,        numberOfMonths: 1,        format: "m/d/Y",        timepicker:false,        scrollInput: false,        onClose: function(selectedDate) {            alert("sfsfs");        }    });    /*$("#apt_time").datetimepicker({        format: "g:i A",        formatTime: 'g:i A',        ampm: true,        datepicker:false,        step:30,        scrollInput: false,        onClose: function(selectedDate) {        }    });*/    $.validator.addMethod("dateHigherThanToday", function(value, element) {        //If false, the validation fails and the message below is displayed        var month = value.substring(0, 2);        var date = value.substring(3, 5);        var year = value.substring(6, 10);        var startDate = new Date(year, month - 1, date);        var currentDate = new Date();        startDate = parseInt(startDate.getFullYear()+""+("0" + (startDate.getMonth() + 1)).slice(-2)+""+("0" + (startDate.getDate())).slice(-2));        currentDate = parseInt(currentDate.getFullYear()+""+("0" + (currentDate.getMonth() + 1)).slice(-2)+""+("0" + (currentDate.getDate())).slice(-2));        return startDate >= currentDate;    }, "Appointment date must be higher than or equal to current date");    // USer login validation & submission    $("#frmBookAppointment").validate({        rules: {            category_id: {                required: true,                digits: true            },            service_id: {                required: true,                digits: true            },            doctor_id: {                required: true,                digits: true            },            patient_count: {                required: true,                digits: true            },            apt_date: {                required: true,                dateHigherThanToday: true            },            apt_time: {                required: true            },            name: {                required: true            },            phone: {                required: true            },            email: {                required: true,                email: true            },            card_holder_name: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            },            card_type: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            },            card_number: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            },            cvv_number: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            },            expiry_month: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            },            expiry_year: {                required: {                    depends: function(element) {                        return $('input:radio[name=payment_type]:checked').val()=="paypal"                    }                }            }        }    });});</script><?php include(LIB_HTML . 'footer.php');?>